XST Print Admin Roadmap
=======================

This is an attempt to map our knowledge of the printer configuration problem.

Index
-----

1      Printcap

2      Filters
2.1    Red Hat
2.1.1  /var/spool/lpd/<printer>/general.cfg
2.1.2  /var/spool/lpd/<printer>/postscript.cfg
2.1.3  /var/spool/lpd/<printer>/textonly.cfg
2.2    Potato

3      Spoolers
3.1    LPRng
3.2    CUPS

4      Printer Drivers

1  Printcap
-----------



2  Filters
----------

Different distributions handle magic filtering of print files differently. A magic filter determines
the type of file being printed, and converts it, sometimes through several steps, to printer-specific
output. Ghostscript is a traditional step in this pipeline.

2.1  Red Hat
------------

Red Hat 7.0 has a master filter, which resides in /usr/lib/rhs/rhs-printfilters/master-filter. This
filter is linked from the printer's spool directory. For each configured printer, there is a number of
configuration files that affect the operation of the filter. Note that the variables defined in these
files sometimes have the keyword "export" in front of them. We need to handle this gracefully.

2.1.1  /var/spool/lpd/<printer>/general.cfg
-------------------------------------------

This file holds the following options (with example values set):

DESIRED_TO=ps
PAPERSIZE=letter
PRINTER_TYPE=LOCAL
ASCII_TO_PS=YES

2.1.2  /var/spool/lpd/<printer>/postscript.cfg
----------------------------------------------

This file holds the following options (with example values set):

GSDEVICE=uniprint   Ghostscript device to use when converting from Postscript to native printer output.
                    Examples are uniprint and cdj890 (HP DeskJet 890). Passed to Ghostscript as
                    -sDEVICE=<device>.

RESOLUTION=NAxNA    Resolution to print at. This is usually Xdpi * Ydpi, but can also be NAxNA for
                    printers that don't allow this setting.
COLOR=stcany
PAPERSIZE=letter
EXTRA_GS_OPTIONS=""
REVERSE_ORDER=
PS_SEND_EOF=NO

# following is related to printing multiple pages per output page
NUP=1
RTLFTMAR=18
TOPBOTMAR=18

2.1.3  /var/spool/lpd/<printer>/textonly.cfg
--------------------------------------------

This file holds the following options (with example values set):

TEXTONLYOPTIONS=
CRLFTRANS=
TEXT_SEND_EOF=NO

2.2  Potato
-----------

3  Spoolers
-----------

3.1  LPRng
----------

Red Hat uses LPRng by default, but you can get RPMs for CUPS as well. CUPS and LPRng are mutually
exclusive, as both install similar binaries related to queue control.

3.2  CUPS
---------

Might be a default on some systems.

4  Printer Drivers
------------------

Traditionally, printer drivers reside in the Ghostscript package. Extensions to the Ghostscript
driver database are available through the Omni package (which needs you to patch Ghostscript), and
probably from other places as well. Use the following command to query the installed Ghostscript
drivers:

echo "devicenames ==" | gs -q -dNODISPLAY -

This will only list the names of the available drivers. I don't think it's possible to query
individual drivers (GS knows a lot about them, but won't tell) - hence metadata has to be provided
separately. See the next section for how this is done in Red Hat.

4.1  Red Hat
------------

Red Hat has a printer metadatabase for their native (and aging) PrintTool. This database is in
/usr/lib/rhs/rhs-printfilters/printerdb. The format for this file is described within the file
itself. This file is _only_ used in the interface, presenting the user with options to choose
from when configuring a printer. The selected options are then written to the .cfg files (see
sections [2.1.1-2.1.3]). So, this file is irrelevant after the printer is configured.

